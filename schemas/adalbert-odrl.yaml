# ==============================================================================
# Adalbert — ODRL 2.2 Structural Wrappers
# ==============================================================================
# LinkML declarations for the ODRL 2.2 base vocabulary classes and slots.
# Every class and slot carries the correct class_uri / slot_uri for RDF export.
#
# This file is a structural wrapper: it does not import from the ODRL IRI but
# re-declares the vocabulary with the correct URIs so LinkML generators can
# produce semantically correct OWL/SHACL output.
#
# Imports: adalbert-core.yaml, adalbert-due.yaml
# Used by: schemas/examples/, schemas/vocabulary/
#
# Gap register (constructs not expressible in LinkML):
#   - owl:TransitiveProperty on odrl:partOf — not expressible; noted in core
#   - ODRL inference rules (granting odrl:use implies sub-actions) — OWL only
#   - odrl:conflict defaulting at profile level — SHACL-only (adalbert-shacl.ttl)
#   - odrl:xone on LogicalConstraint — not expressible; omitted
# ==============================================================================

id: https://vocabulary.bigbank/adalbert/linkml/odrl
name: adalbert_odrl
title: Adalbert ODRL 2.2 Wrappers
description: >-
  LinkML structural wrappers for ODRL 2.2 vocabulary.
  Classes and slots are declared with correct class_uri/slot_uri for RDF export.
  Does not import from the ODRL IRI; declares locally with correct namespace URIs.
version: "0.7"

prefixes:
  linkml: https://w3id.org/linkml/
  odrl: http://www.w3.org/ns/odrl/2/
  rdfs: http://www.w3.org/2000/01/rdf-schema#
  xsd: http://www.w3.org/2001/XMLSchema#

default_range: string

imports:
  - linkml:types

# ==============================================================================
# CLASSES
# ==============================================================================

classes:

  # --------------------------------------------------------------------------
  # Policy hierarchy
  # --------------------------------------------------------------------------

  Policy:
    class_uri: odrl:Policy
    abstract: true
    description: >-
      Abstract base for ODRL policy types. Concrete instances are Set, Offer,
      or Agreement. Not instantiated directly.
    slots:
      - id
      - label
      - description
      - profile
      - conflict
      - target
      - assigner
      - assignee
      - permission
      - prohibition
      - obligation

  Set:
    class_uri: odrl:Set
    is_a: Policy
    description: >-
      An ODRL Policy Set. No parties declared; applies to anyone matching
      the conditions. Used for internal access policies and data use policies.

  Offer:
    class_uri: odrl:Offer
    is_a: Policy
    description: >-
      An ODRL Policy Offer from a data provider. When accepted, becomes an
      Agreement. Adalbert subtypes this as DataContract.

  Agreement:
    class_uri: odrl:Agreement
    is_a: Policy
    description: >-
      An ODRL Policy Agreement between parties. Bilateral. Adalbert subtypes
      this as Subscription.

  # --------------------------------------------------------------------------
  # Rule hierarchy
  # --------------------------------------------------------------------------

  Rule:
    class_uri: odrl:Rule
    abstract: true
    description: >-
      Abstract base for Permission, Prohibition, and Duty. Not instantiated
      directly.
    slots:
      - id
      - label
      - action
      - target
      - assignee
      - constraint

  Permission:
    class_uri: odrl:Permission
    is_a: Rule
    description: A usage right granted to one or more parties.

  Prohibition:
    class_uri: odrl:Prohibition
    is_a: Rule
    description: A restriction on data use.

  Duty:
    class_uri: odrl:Duty
    is_a: Rule
    description: An obligation borne by a party.

  # --------------------------------------------------------------------------
  # Constraint types
  # --------------------------------------------------------------------------

  Constraint:
    class_uri: odrl:Constraint
    description: >-
      An atomic condition: leftOperand operator rightOperand.
      Evaluated during policy processing.
    slots:
      - id
      - label
      - leftOperand
      - operator
      - rightOperand

  LogicalConstraint:
    class_uri: odrl:LogicalConstraint
    is_a: Constraint
    description: >-
      A compound constraint combining atomic constraints with and/or.
      GAP: odrl:xone not expressible in LinkML; omitted.
      GAP: constraint semantics (strict boolean evaluation) are documented
      but not enforced by LinkML; requires SHACL or runtime validator.
    slots:
      - and
      - or

  # --------------------------------------------------------------------------
  # Asset and Party
  # --------------------------------------------------------------------------

  Asset:
    class_uri: odrl:Asset
    description: A data asset referenced in policies and rules.
    slots:
      - id
      - label

  Party:
    class_uri: odrl:Party
    description: A party (agent or organization) referenced in policies and rules.
    slots:
      - id
      - label

  # --------------------------------------------------------------------------
  # LeftOperand and Action (vocabulary classes)
  # --------------------------------------------------------------------------

  LeftOperand:
    class_uri: odrl:LeftOperand
    description: >-
      An operand on the left side of a constraint comparison.
      DUE operands are instances of this class (or DUELeftOperand subclass).
    slots:
      - id
      - label

  Action:
    class_uri: odrl:Action
    description: >-
      An action referenced in permissions, prohibitions, and duties.
      DUE actions are instances of this class (or DUEAction subclass).
    slots:
      - id
      - label
      - includedIn

# ==============================================================================
# SLOTS
# ==============================================================================

slots:

  # --------------------------------------------------------------------------
  # Identity
  # --------------------------------------------------------------------------

  id:
    identifier: true
    description: >-
      Unique identifier for the resource. May be a full URI or a prefixed name.
      Maps to the RDF subject IRI.
    range: string
    required: true

  label:
    slot_uri: rdfs:label
    description: Human-readable label.
    range: string

  description:
    slot_uri: rdfs:comment
    description: Longer description or annotation.
    range: string

  # --------------------------------------------------------------------------
  # Policy-level slots
  # --------------------------------------------------------------------------

  profile:
    slot_uri: odrl:profile
    description: URI(s) of the ODRL profile(s) this policy conforms to.
    range: uri
    multivalued: true

  conflict:
    slot_uri: odrl:conflict
    description: >-
      Conflict resolution strategy. Adalbert fixes this to odrl:prohibit
      at the profile level (declared in adalbert-prof.ttl).
      GAP: profile-level default not expressible in LinkML; SHACL-only.
    range: string

  assigner:
    slot_uri: odrl:assigner
    description: The party assigning/offering the policy.
    range: string

  assignee:
    slot_uri: odrl:assignee
    description: The party accepting or bound by the policy or rule.
    range: string

  target:
    slot_uri: odrl:target
    description: >-
      The data asset targeted by the policy or rule.
      Rule-level target overrides the policy-level target.
      Rules without an explicit target inherit from the policy-level target
      (ODRL standard inheritance pattern).
      OWL allows multiple targets; Adalbert examples use one target per resource.
    range: string

  # --------------------------------------------------------------------------
  # Rule list slots (on Policy)
  # --------------------------------------------------------------------------

  permission:
    slot_uri: odrl:permission
    description: Permission rule(s) in a policy.
    range: Permission
    multivalued: true
    inlined_as_list: true

  prohibition:
    slot_uri: odrl:prohibition
    description: Prohibition rule(s) in a policy.
    range: Prohibition
    multivalued: true
    inlined_as_list: true

  obligation:
    slot_uri: odrl:obligation
    description: Duty rule(s) in a policy.
    range: Duty
    multivalued: true
    inlined_as_list: true

  # --------------------------------------------------------------------------
  # Rule-level slots
  # --------------------------------------------------------------------------

  action:
    slot_uri: odrl:action
    description: The action being permitted, prohibited, or required.
    range: string
    required: true

  constraint:
    slot_uri: odrl:constraint
    description: Constraint(s) on a rule.
    range: Constraint
    multivalued: true
    inlined_as_list: true

  # --------------------------------------------------------------------------
  # Constraint slots
  # --------------------------------------------------------------------------

  leftOperand:
    slot_uri: odrl:leftOperand
    description: >-
      The operand on the left side of a constraint comparison.
      References a LeftOperand individual (e.g., adalbert-due:purpose).
    range: string
    required: true

  operator:
    slot_uri: odrl:operator
    description: >-
      The comparison operator. ODRL defines: eq, neq, gt, gteq, lt, lteq,
      isPartOf, isAllOf, isAnyOf, isNoneOf.
    range: string
    required: true

  rightOperand:
    slot_uri: odrl:rightOperand
    description: >-
      The value to compare against. May be a concept value URI, a literal,
      or a typed value (e.g., "PT30M"^^xsd:duration).
    range: string
    required: true

  # --------------------------------------------------------------------------
  # LogicalConstraint slots
  # --------------------------------------------------------------------------

  and:
    slot_uri: odrl:and
    description: All sub-constraints must be satisfied (logical AND).
    range: Constraint
    multivalued: true
    inlined_as_list: true

  or:
    slot_uri: odrl:or
    description: At least one sub-constraint must be satisfied (logical OR).
    range: Constraint
    multivalued: true
    inlined_as_list: true

  # --------------------------------------------------------------------------
  # Action hierarchy slot
  # --------------------------------------------------------------------------

  includedIn:
    slot_uri: odrl:includedIn
    description: >-
      Parent action in the action hierarchy. Granting the parent implies
      granting this action (permission subsumption).
      GAP: subsumption inference is not enforced by LinkML; requires OWL
      reasoner or Adalbert runtime enforcement.
    range: string
