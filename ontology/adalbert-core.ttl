# =============================================================================
# Adalbert Core Ontology — ODRL 2.2 Profile Extension
# Version: 0.7
# Date: 2026-02-04
# =============================================================================
# Adalbert is a proper ODRL 2.2 profile. It uses ODRL terms wherever ODRL
# defines them and only adds terms for genuinely new capabilities:
#
#   - Duty lifecycle (State + state property)
#   - Deadline on duties
#   - Recurrence on duties (RFC 5545 RRULE)
#   - Data contracts and subscriptions (domain subtypes)
#   - Asset/party hierarchy (partOf, memberOf)
#   - Structured operand resolution (resolutionPath)
#   - Runtime references (RuntimeReference, currentAgent, currentDateTime)
#   - Logical negation (not)
#
# Everything else — Rule types, Policy types, Constraint types, operators,
# core properties — comes from ODRL 2.2 directly.
# =============================================================================

@prefix adalbert:    <https://vocabulary.bigbank/adalbert/> .
@prefix rl2:     <https://vocabulary.bigbank/rl2/> .
@prefix odrl:    <http://www.w3.org/ns/odrl/2/> .
@prefix owl:     <http://www.w3.org/2002/07/owl#> .
@prefix rdf:     <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs:    <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd:     <http://www.w3.org/2001/XMLSchema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix skos:    <http://www.w3.org/2004/02/skos/core#> .

# =============================================================================
# ONTOLOGY DECLARATION
# =============================================================================

<https://vocabulary.bigbank/adalbert/> a owl:Ontology, odrl:Profile ;
    dcterms:title "Adalbert Core Ontology"@en ;
    dcterms:description """
        Adalbert: a proper ODRL 2.2 profile for deterministic data governance.

        Uses ODRL terms for all standard constructs (Rule types, Policy types,
        Constraint types, operators, core properties). Adds only:
        - Explicit duty lifecycle (Pending -> Active -> Fulfilled/Violated)
        - Deadline property on odrl:Duty
        - Recurrence property on odrl:Duty (RFC 5545 RRULE)
        - Data contract and subscription subtypes
        - Asset/party hierarchy properties
        - Structured operand resolution via resolutionPath
        - Runtime references for dynamic right-operand values
        - Logical negation (not) on LogicalConstraint

        Adalbert policies are valid ODRL 2.2 policies. Any ODRL processor can
        partially understand them; Adalbert-aware processors handle the
        extensions.
    """@en ;
    dcterms:created "2026-02-02"^^xsd:date ;
    dcterms:modified "2026-02-04"^^xsd:date ;
    owl:versionInfo "0.7" ;
    owl:versionIRI <https://vocabulary.bigbank/adalbert/0.7> ;
    rdfs:seeAlso <https://vocabulary.bigbank/rl2/> ,
                 <http://www.w3.org/ns/odrl/2/> .

# =============================================================================
# PROFILE CONSTRAINTS (documentation of ODRL usage)
# =============================================================================
# Adalbert fixes odrl:conflict to odrl:prohibit (prohibition overrides).
# Adalbert does not use: odrl:Ticket, odrl:Request, odrl:AssetCollection,
# odrl:PartyCollection, odrl:remedy, odrl:consequence, odrl:xone.

# =============================================================================
# LIFECYCLE STATE (genuinely new)
# =============================================================================

adalbert:State a owl:Class ;
    rdfs:label "State"@en ;
    skos:definition "Unified lifecycle state for duties and contracts."@en ;
    owl:oneOf (adalbert:Pending adalbert:Active adalbert:Fulfilled adalbert:Violated) ;
    rdfs:comment """
        Four states cover both duty and contract lifecycles:
        - Pending: condition not yet met / not yet in force
        - Active: condition met, action required / in force
        - Fulfilled: action performed / obligations complete
        - Violated: deadline passed / breached
    """@en .

adalbert:Pending a adalbert:State ;
    rdfs:label "Pending"@en ;
    skos:definition "Condition not yet satisfied; not yet in force."@en .

adalbert:Active a adalbert:State ;
    rdfs:label "Active"@en ;
    skos:definition "Condition satisfied, action required; in force."@en .

adalbert:Fulfilled a adalbert:State ;
    rdfs:label "Fulfilled"@en ;
    skos:definition "Action performed; obligations complete."@en .

adalbert:Violated a adalbert:State ;
    rdfs:label "Violated"@en ;
    skos:definition "Deadline passed without performance; breached."@en .

adalbert:state a owl:ObjectProperty ;
    rdfs:label "state"@en ;
    skos:definition "Current lifecycle state."@en ;
    rdfs:domain [ owl:unionOf (odrl:Duty adalbert:DataContract adalbert:Subscription) ] ;
    rdfs:range adalbert:State .

# =============================================================================
# DEADLINE (genuinely new)
# =============================================================================

adalbert:deadline a owl:DatatypeProperty ;
    rdfs:label "deadline"@en ;
    skos:definition "Time constraint for duty fulfillment."@en ;
    rdfs:domain odrl:Duty ;
    rdfs:comment """
        Supports multiple forms:
        - xsd:dateTime: absolute deadline (e.g., 2026-12-31T23:59:59Z)
        - xsd:duration: relative to activation (e.g., P30D, PT24H)

        For duration: deadline = activationTime + duration.
        No rdfs:range declared because the range is a union of datatypes;
        SHACL enforces the allowed types.
    """@en .

# =============================================================================
# RECURRENCE (genuinely new)
# =============================================================================

adalbert:recurrence a owl:DatatypeProperty ;
    rdfs:label "recurrence"@en ;
    skos:definition "RFC 5545 RRULE defining when duty instances are generated."@en ;
    rdfs:domain odrl:Duty ;
    rdfs:range xsd:string ;
    rdfs:comment """
        An RFC 5545 RRULE string (e.g., FREQ=DAILY;BYHOUR=6;BYMINUTE=0).
        Defines the schedule on which duty instances are created.
        Each instance follows the standard duty lifecycle independently.
        The deadline property defines the per-instance fulfillment window.
        Any iCal-compliant library can parse the value.
    """@en .

# =============================================================================
# CONTRACT CLASSES (genuinely new — domain subtypes)
# =============================================================================

adalbert:DataContract a owl:Class ;
    rdfs:label "Data Contract"@en ;
    skos:definition "Policy offer defining data access terms."@en ;
    rdfs:subClassOf odrl:Offer ;
    rdfs:comment """
        A DataContract is an Offer from a data provider.
        It defines permissions, duties, and prohibitions for data access.

        When accepted (subscribed), becomes a Subscription (Agreement).
    """@en .

adalbert:Subscription a owl:Class ;
    rdfs:label "Subscription"@en ;
    skos:definition "Activated data contract binding provider and consumer."@en ;
    rdfs:subClassOf odrl:Agreement ;
    rdfs:comment """
        A Subscription is an activated DataContract.
        - assigner: data provider (from contract)
        - assignee: data consumer (subscriber)

        Bilateral: both parties may have active duties.
    """@en .

# =============================================================================
# CONTRACT PROPERTIES (genuinely new)
# =============================================================================

adalbert:subscribesTo a owl:ObjectProperty ;
    rdfs:label "subscribes to"@en ;
    skos:definition "The contract this subscription activates."@en ;
    rdfs:domain adalbert:Subscription ;
    rdfs:range adalbert:DataContract .

adalbert:effectiveDate a owl:DatatypeProperty ;
    rdfs:label "effective date"@en ;
    skos:definition "When the contract/subscription becomes effective."@en ;
    rdfs:domain [ owl:unionOf (adalbert:DataContract adalbert:Subscription) ] ;
    rdfs:range xsd:dateTime .

adalbert:expirationDate a owl:DatatypeProperty ;
    rdfs:label "expiration date"@en ;
    skos:definition "When the contract/subscription expires."@en ;
    rdfs:domain [ owl:unionOf (adalbert:DataContract adalbert:Subscription) ] ;
    rdfs:range xsd:dateTime .

# =============================================================================
# HIERARCHY EXTENSIONS (genuinely new)
# =============================================================================

adalbert:partOf a owl:ObjectProperty, owl:TransitiveProperty ;
    rdfs:label "part of"@en ;
    skos:definition "Asset contained in larger asset."@en ;
    rdfs:domain odrl:Asset ;
    rdfs:range odrl:Asset ;
    rdfs:comment "Transitive: table partOf schema, schema partOf database."@en .

adalbert:memberOf a owl:ObjectProperty, owl:TransitiveProperty ;
    rdfs:label "member of"@en ;
    skos:definition "Party member of group/organization."@en ;
    rdfs:domain odrl:Party ;
    rdfs:range odrl:Party ;
    rdfs:comment "Transitive: person memberOf team, team memberOf division."@en .

# =============================================================================
# OPERAND RESOLUTION (genuinely new)
# =============================================================================

adalbert:resolutionPath a owl:DatatypeProperty ;
    rdfs:label "resolution path"@en ;
    skos:definition "Dot-separated path from canonical root to value."@en ;
    rdfs:domain odrl:LeftOperand ;
    rdfs:range xsd:string ;
    rdfs:comment """
        Path must start with a canonical root: agent, asset, context.
        Examples: agent.role, asset.classification, context.purpose.
        Resolution: resolve(path, Env) -> Value
    """@en .

# =============================================================================
# RUNTIME REFERENCES (genuinely new)
# =============================================================================

adalbert:RuntimeReference a owl:Class ;
    rdfs:label "Runtime Reference"@en ;
    skos:definition "Value resolved at evaluation time."@en .

adalbert:currentAgent a adalbert:RuntimeReference, odrl:Party ;
    rdfs:label "current agent"@en ;
    skos:definition "The requesting agent."@en ;
    rdfs:comment """
        Runtime reference resolved at evaluation time to the actual
        requesting agent. Used in constraint right-operands for dynamic
        comparisons (e.g., identity binding). Typed as both
        RuntimeReference and odrl:Party for ODRL processor compatibility.
        Note: for rules that apply to any requesting agent, omit
        odrl:assignee (standard ODRL); do not use currentAgent as assignee.
    """@en .

adalbert:currentDateTime a odrl:LeftOperand, adalbert:RuntimeReference ;
    rdfs:label "current date time"@en ;
    skos:definition "Evaluation timestamp."@en ;
    skos:exactMatch odrl:dateTime .

# =============================================================================
# LOGICAL NEGATION (genuinely new — ODRL lacks this)
# =============================================================================

adalbert:not a owl:ObjectProperty ;
    rdfs:label "not"@en ;
    skos:definition "Logical negation on a constraint."@en ;
    rdfs:domain odrl:LogicalConstraint ;
    rdfs:range [ owl:unionOf (odrl:Constraint odrl:LogicalConstraint) ] ;
    rdfs:comment """
        ODRL defines odrl:and and odrl:or on LogicalConstraint but lacks
        negation. Adalbert adds adalbert:not following the same pattern:
          _:lc a odrl:LogicalConstraint ;
              adalbert:not _:c1 .
    """@en .

# =============================================================================
# END OF ONTOLOGY
# =============================================================================
